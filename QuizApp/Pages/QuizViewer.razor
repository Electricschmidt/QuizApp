@page "/QuizViewer"

@using QuizApp.Data

<h3>QuizViewer</h3>
@if (quizStarted == false)
{
    <h2>Welcome to the capital cities quiz!</h2>
    <button class="btn btn-primary" @onclick="StartQuiz">Press to begin</button>
}

else
{
<p>What is the capital of @question.QuestionCountry?</p>

@foreach (string option in question.Options)
{
    var buttonText = option;
    <button class="btn btn-primary" @onclick="@(e => GetNewQuestion(buttonText))">@option</button>
}

@*<p>@answer</p>*@
<p>Score: @score</p>
}
@code {
    static string filename = "wwwroot/Countries/country-capitals.csv";
    static CsvReader csvreader = new CsvReader(filename);
    static List<Country> countries = csvreader.ReadAllCountries();
    public static QuizItem question = new QuizItem(countries);
    public int score = 0;
    bool quizStarted = false;
    public string answer = question.QuestionAnswer;

    public void StartQuiz()
    {
        quizStarted = true;
    }

    public void GetNewQuestion(string resp)
    {
        if (resp == question.QuestionAnswer)
        {
            question = new QuizItem(countries);
            answer = question.QuestionAnswer;
            score++;
        }
        else
        {
            question = new QuizItem(countries);
            answer = question.QuestionAnswer;
        }

    }


    public bool CheckAnswer(string answer, QuizItem question)
    {
        if (answer == question.QuestionAnswer)
        {
            return true;
        }
        else
        {
            return false;
        }
    }

}
